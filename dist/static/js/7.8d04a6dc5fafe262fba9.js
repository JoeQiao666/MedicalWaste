webpackJsonp([7],{"+wCp":function(t,e){},"5XkK":function(t,e){},uqHj:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=a("ryJa");var s={data:()=>({loading:!1,loading2:!1,title:"近30天各科室产生医废总量",type:"1",activeName:"1",kName:"",date:"",columns:[],data1:[],tableData:[{id:1,name:"输液大厅",weight:"71.25",weight1:"21.25",weight2:"13.14",weight3:"",weight4:"",weight5:""}],total:0,cur_page:1,pickerOptions:{shortcuts:[{text:"最近一周",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},chooseIds:[]}),methods:{formatter(t,e){var a=t[e.property];return""==a?a="0kg":a+="kg",a},handleCurrentChange(t){this.cur_page=t,this.getTable()},handleClick(t,e){1==t.index?(this.type=2,this.title="近30天各科室产生盐水瓶总重量"):(this.type=1,this.title="近30天各科室产生医废总量"),this.getData(),this.getTable()},intChart1(t){void 0===this.chart1?(this.chart1=new G2.Chart({container:"mountNode1",forceFit:!0,height:300,padding:[20,"auto",50,"auto"]}),this.chart1.source(t),this.chart1.legend(!1),this.chart1.tooltip({itemTpl:"<li>总重量: {value}</li>",position:"left"}),this.chart1.interval().position("departmentName*total").opacity(1).label("value",{useHtml:!0,htmlTemplate:function(t,e){return'<span class="g2-label-item"><p class="g2-label-item-value">'+e.point.total+"kg</p></div>"}}).color("departmentName",["#7f8da9","#fec514","#db4c3c","#daf0fd"]),this.chart1.render()):this.chart1.changeData(t)},handleSelectionChange(t){var e=t.map(t=>t.id);this.chooseIds=e},getExcel(t){1==t||(2==t?0==this.chooseIds.length&&this.$message({message:"请选择需要要导出明细的诊所！"}):this.$confirm("确定导出全部明细?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message({type:"success",message:"导出成功!"})}).catch(()=>{}))},exportExcel(){window.open("/platform/hospital/rubbish/exportWeightByDepartment?isBottle=true")},getSummaries(t){const{columns:e,data:a}=t,i=[];return e.forEach((t,e)=>{if(0===e)return void(i[e]="");if(1===e)return void(i[e]="合计");const s=a.map(e=>Number(e[t.property]));s.every(t=>isNaN(t))||(i[e]=s.reduce((t,e)=>{const a=Number(e);return isNaN(a)?t:(100*t+100*e)/100},0),i[e]+=" kg")}),i},getData(){this.loading=!0;var t="";t=1==this.activeName?"/platform/hospital/rubbish/weightPerDayInLastMonthByDepartment?isBottle=false":"/platform/hospital/rubbish/weightPerDayInLastMonthByDepartment?isBottle=true",this.$axios({method:"get",url:t}).then(t=>{200==t.status?(this.loading=!1,this.intChart1(t.data)):this.$message.error(t.data.msg)}).catch(t=>{console.log(t)})},getTable(){this.loading2=!0;var t="";t=1==this.activeName?"/platform/hospital/rubbish/weightPerDayByDepartment?start="+this.date[0]+"&end="+this.date[1]+"&name="+this.kName+"&pageNumber="+this.cur_page+"&pageSize=10&isBottle=false":"/platform/hospital/rubbish/weightPerDayByDepartment?start="+this.date[0]+"&end="+this.date[1]+"&name="+this.kName+"&pageNumber="+this.cur_page+"&pageSize=10&isBottle=true",this.$axios({method:"get",url:t}).then(t=>{if(200==t.status){this.loading2=!1;var e=[],a=t.data.list.map((t,a)=>{var i={departmentName:t.departmentName,total:t.total};return t.typeNames=t.typeNames.split(","),t.totals=t.totals.split(","),t.typeNames.forEach((s,l)=>{i[s]=parseFloat(t.totals[l]),0==a&&e.push(s)}),i});this.columns=e,this.tableData=a,this.total=t.data.totalCount}else this.$message.error(t.data.msg)}).catch(t=>{console.log(t)})}},mounted(){var t=i().format("YYYY-MM-DD"),e=i().subtract(30,"days").format("YYYY-MM-DD");this.date=[e,t],setTimeout(()=>{this.getData(),this.getTable()},500)}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-location-outline"}),t._v(" 统计分析\n      ")]),t._v(" "),i("el-breadcrumb-item",[t._v("\n        科室统计\n      ")])],1)],1),t._v(" "),i("div",{staticClass:"container"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"医废类",name:"1"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"盐水瓶",name:"2"}})],1),t._v(" "),i("div",{staticClass:"cloudBox"},[i("div",{staticClass:"flex  headSelect",staticStyle:{"margin-bottom":"30px","min-height":"auto"}},[i("div",{staticClass:"flex "},[i("img",{staticClass:"titleIcon",attrs:{src:a("p/ZW"),alt:""}}),t._v(" "),i("div",[t._v(t._s(t.title))])])]),t._v(" "),t._m(0)])],1),t._v(" "),i("div",{staticClass:"borderBox"},[i("div",{staticClass:"flex headSelect",staticStyle:{"margin-bottom":"10px"}},[t._m(1),t._v(" "),i("div",{staticClass:"flex funcHead"},[i("div",{staticClass:"block"},[i("span",{staticClass:"demonstration"},[t._v("重量统计时间：")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"280px"},attrs:{"picker-options":t.pickerOptions,type:"daterange","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),i("div",{staticClass:"flex",staticStyle:{"margin-left":"10px"}},[i("span",{staticClass:"demonstration",staticStyle:{width:"68px"}},[t._v("科室名称：")]),t._v(" "),i("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"请输入科室名称"},model:{value:t.kName,callback:function(e){t.kName=e},expression:"kName"}})],1),t._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.getTable}},[t._v("搜索")]),t._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.exportExcel}},[t._v("导出报表")])],1)]),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"show-summary":"","summary-method":t.getSummaries},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"departmentName",label:"科室"}}),t._v(" "),i("el-table-column",{attrs:{prop:"total",sortable:"",label:"总重量",formatter:t.formatter}}),t._v(" "),t._l(t.columns,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e,sortable:"",label:e,formatter:t.formatter}})})],2),t._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex",staticStyle:{"align-items":"normal"}},[e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{"font-size":"14px"},attrs:{align:"left"}},[this._v("赛虹桥卫生服务中心")]),this._v(" "),e("div",{staticClass:"canvas",attrs:{id:"mountNode1"}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex"},[e("img",{staticClass:"titleIcon",attrs:{src:a("xxCs"),alt:""}}),this._v(" "),e("div",{staticStyle:{"margin-top":"-4px"}},[this._v("各科室重量统计")])])}]};var r=a("C7Lr")(s,l,!1,function(t){a("+wCp"),a("5XkK")},"data-v-41fff043",null);e.default=r.exports}});
//# sourceMappingURL=7.8d04a6dc5fafe262fba9.js.map