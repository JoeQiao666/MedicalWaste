webpackJsonp([12],{"/jMt":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=l(a("N3gQ")),s=l(a("RwR+"));function l(t){return t&&t.__esModule?t:{default:t}}var r=a("ryJa");e.default={data:function(){return{loading:!1,loading1:!1,loading2:!1,permission:!1,dateType:"daterange",types:[],columns:[],startYear:"",endYear:"",activeName:"1",kName:"",date:"",cType:"day",type:"1",tableData:[],tableData2:[],total:0,total1:0,total2:0,vFormate:"yyyy-MM-dd",cur_page:1,cur_page2:1,chooseIds:[],tableVisble1:!1,tableVisble2:!1,editVisible:!1,ruleForm:{type:""},details:(t={administratorId:"",typeName:"",weight:"",staffName:"",recycleTime:"",createdTime:"",companyName:"",administratorName:""},e="administratorName",a="",e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t)};var t,e,a},watch:{cType:{handler:function(t){if("day"==t){this.dateType="daterange",this.vFormate="yyyy-MM-dd";var e=r().format("YYYY-MM-DD"),a=r().subtract(30,"days").format("YYYY-MM-DD");this.date=[a,e]}else if("month"==t){this.dateType="monthrange",this.vFormate="yyyy-MM";e=r().format("YYYY-MM"),a=r().subtract(1,"year").format("YYYY-MM");this.date=[a,e]}else{e=r().format("YYYY"),a=r().subtract(1,"year").format("YYYY");this.date=[a,e],this.startYear=a,this.endYear=e}},deep:!0}},methods:{formatter:function(t,e){var a=t[e.property];return void 0==a?"-":(""==a?a="0kg":a+="kg",a)},formatterStatus:function(t,e){var a=t.status;return a=1==a?"暂存点已入库":"暂存点未入库"},formatterType:function(t,e){var a=t.type;return a=1==a?"感染性":"损伤性"},handleCurrentChange:function(t){this.cur_page=t,this.getTable()},handleCurrentChange2:function(t){this.cur_page2=t,this.getDetailTable()},handleClick:function(t,e){1==t.index?this.type=2:this.type=1,this.getType(),this.getTable()},handleSelectionChange:function(t){var e=t.map(function(t){return t.id});this.chooseIds=e},getExcel:function(t){window.open("/platform/hospital/rubbish/exportWeightByDepartment?isBottle=true&status=1")},getExcel1:function(t){var e=s.default.utils.table_to_book(document.querySelector("#out-table")),a=s.default.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{i.default.saveAs(new Blob([a],{type:"application/octet-stream"}),"sheetjs.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,a)}return a},getExcel2:function(t){},getSummaries:function(t){var e=t.columns,a=t.data,i=[];return e.forEach(function(t,e){if(0!==e)if(1!==e)if("操作记录"!=t.label){var s=a.map(function(e){return Number(e[t.property])});s.every(function(t){return isNaN(t)})||(i[e]=s.reduce(function(t,e){var a=Number(e);return isNaN(a)?t:(100*t+100*e)/100},0),2!==e&&(i[e]+=" kg"))}else i[e]="";else i[e]="合计";else i[e]=""}),i},yearChange:function(t,e){var a=this.date;1==e?a[0]=t:a[1]=t,this.startYear>=this.endYear&&(this.endYear="",a[1]=""),this.date=a},detials:function(t,e,a){1==a?(this.tableVisble1=!0,this.storeTime=e.storeTime,this.getDetailTable(e.storeTime)):2==a&&(e.storeTime=r(parseFloat(e.storeAt)).format("YYYY-MM-DD HH:mm:ss"),e.recycleTime=r(parseFloat(e.recycleAt)).format("YYYY-MM-DD HH:mm:ss"),this.details=e,this.tableVisble2=!0)},edit:function(t,e){this.editVisible=!0,this.editId=e.id,this.ruleForm.type=e.typeId},saveEdit:function(){var t=this;this.loading2=!0,this.$axios({method:"put",url:"/platform/hospital/rubbish/editType?id="+this.editId+"&typeId="+this.ruleForm.type}).then(function(e){200==e.status?(t.loading2=!1,t.editVisible=!1,t.getDetailTable(t.storeTime)):t.$message.error(e.data.msg)}).catch(function(t){console.log(t)})},getTable:function(){var t=this;this.loading=!0;var e="";e=1==this.activeName?"/platform/hospital/rubbish/weightPerType?formatType="+this.cType+"&start="+this.date[0]+"&end="+this.date[1]+"&isBottle=false&status=1&pageNumber="+this.cur_page+"&pageSize=10":"/platform/hospital/rubbish/weightPerType?formatType="+this.cType+"&start="+this.date[0]+"&end="+this.date[1]+"&isBottle=true&status=1&pageNumber="+this.cur_page+"&pageSize=10",this.$axios({method:"get",url:e}).then(function(e){if(200==e.status){t.loading=!1;var a=[],i=e.data.list.map(function(t,e){var i={storeTime:t.storeTime,total:t.total,storeTimes:1};return t.typeNames=t.typeNames.split(","),t.totals=t.totals.split(","),t.typeNames.forEach(function(s,l){i[s]=parseFloat(t.totals[l]),0==e&&a.push(s)}),i});t.columns=a,t.tableData=i,t.total=e.data.totalCount}else t.$message.error(e.data.msg)}).catch(function(t){console.log(t)})},getDetailTable:function(t){var e=this;this.loading1=!0;var a="";a=1==this.activeName?"/platform/hospital/rubbish/listPageByDate?formatType="+this.cType+"&date="+t+"&isBottle=false&status=1&pageNumber="+this.cur_page2+"&pageSize=10":"/platform/hospital/rubbish/listPageByDate?formatType="+this.cType+"&date="+t+"&isBottle=true&status=1&pageNumber="+this.cur_page2+"&pageSize=10",this.$axios({method:"get",url:a}).then(function(t){200==t.status?(e.loading1=!1,e.tableData2=t.data.list,e.total2=t.data.totalCount):e.$message.error(t.data.msg)}).catch(function(t){console.log(t)})},getType:function(){var t=this,e="";e=1==this.activeName?"/platform/hospital/type/data?isBottle=false":"/platform/hospital/type/data?isBottle=true",this.$axios({method:"get",url:e}).then(function(e){if(200==e.status){t.types=e.data.data;var a={type:e.data.data[0].id};t.ruleForm=a}else t.$message.error(e.data.msg)}).catch(function(t){console.log(t)})}},mounted:function(){this.permission=localStorage.permission;var t=r().format("YYYY-MM-DD"),e=r().subtract(30,"days").format("YYYY-MM-DD");this.date=[e,t],this.getType(),this.getTable()}}},"4mET":function(t,e,a){"use strict";var i={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-location-outline"}),t._v(" 统计分析\n      ")]),t._v(" "),i("el-breadcrumb-item",[t._v("\n        入库统计\n      ")])],1)],1),t._v(" "),i("div",{staticClass:"container"},[i("div",[i("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"医废类",name:"1"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"盐水瓶",name:"2"}})],1)],1),t._v(" "),i("div",{staticClass:"borderBox"},[i("div",{staticClass:"flex headSelect",staticStyle:{"margin-bottom":"10px"}},[i("div",{staticClass:"flex"},[i("img",{staticClass:"titleIcon",attrs:{src:a("xxCs"),alt:""}}),t._v(" "),i("div",{staticStyle:{"margin-top":"-4px"}},[t._v("入库报表")]),t._v(" "),i("div",{staticClass:"radio"},[i("el-radio",{attrs:{label:"day"},model:{value:t.cType,callback:function(e){t.cType=e},expression:"cType"}},[t._v("日统计")]),t._v(" "),i("el-radio",{attrs:{label:"month"},model:{value:t.cType,callback:function(e){t.cType=e},expression:"cType"}},[t._v("月统计")]),t._v(" "),i("el-radio",{attrs:{label:"year"},model:{value:t.cType,callback:function(e){t.cType=e},expression:"cType"}},[t._v("年统计")])],1)]),t._v(" "),i("div",{staticClass:"flex funcHead"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"year"!==t.cType,expression:"cType!=='year'"}],staticClass:"block"},[i("span",{staticClass:"demonstration"},[t._v("重量统计时间：")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"280px"},attrs:{type:t.dateType,"range-separator":"~","value-format":t.vFormate,"start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"year"==t.cType,expression:"cType=='year'"}],staticClass:"block"},[i("span",{staticClass:"demonstration"},[t._v("重量统计时间：")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"100px"},attrs:{"value-format":"yyyy",type:"year"},on:{change:function(e){return t.yearChange(e,1)}},model:{value:t.startYear,callback:function(e){t.startYear=e},expression:"startYear"}}),t._v(" "),i("span",{staticClass:"demonstration"},[t._v("~")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"100px"},attrs:{"value-format":"yyyy",type:"year"},on:{"":function(t){},change:function(e){return t.yearChange(e,2)}},model:{value:t.endYear,callback:function(e){t.endYear=e},expression:"endYear"}})],1),t._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.getTable}},[t._v("搜索")]),t._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.getExcel}},[t._v("导出报表")])],1)]),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"show-summary":"","summary-method":t.getSummaries},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{prop:"storeTime",label:"入库时间"}}),t._v(" "),i("el-table-column",{attrs:{prop:"storeTimes",label:"入库次数"}}),t._v(" "),i("el-table-column",{attrs:{prop:"total",sortable:"",label:"应入库总重量",formatter:t.formatter}}),t._v(" "),t._l(t.columns,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e,sortable:"",label:e,formatter:t.formatter}})}),t._v(" "),i("el-table-column",{attrs:{label:"操作记录",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"pointer",on:{click:function(a){return t.detials(e.$index,e.row,1)}}},[t._v("点击查看")])]}}])})],2),t._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),i("el-dialog",{attrs:{title:"操作记录",visible:t.tableVisble1,width:"80%"},on:{"update:visible":function(e){t.tableVisble1=e}}},[i("div",{staticStyle:{"margin-top":"-40px"},attrs:{align:"right"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.getExcel1}},[t._v("导出报表")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading1,expression:"loading1"}],staticStyle:{width:"100%"},attrs:{data:t.tableData2,id:"out-table"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{prop:"createdTime",label:"新增时间"}}),t._v(" "),i("el-table-column",{attrs:{prop:"departmentName",sortable:"",label:"科室"}}),t._v(" "),i("el-table-column",{attrs:{prop:"weight",sortable:"",label:"重量",formatter:t.formatter}}),t._v(" "),i("el-table-column",{attrs:{prop:"typeName",sortable:"",label:"类型",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"weight2",label:"记录状态"}},[t._v("\n              暂存点已入库\n            ")]),t._v(" "),i("el-table-column",{attrs:{prop:"operatorName",label:"操作人",width:"80"}}),t._v(" "),i("el-table-column",{attrs:{prop:"staffName",label:"交接人",width:"80"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"pointer",on:{click:function(a){return t.detials(e.$index,e.row,2)}}},[t._v("查看详情")]),t._v(" "),"修改"==t.permission?i("span",{staticClass:"pointer",staticStyle:{"margin-left":"10px"},on:{click:function(a){return t.edit(e.$index,e.row)}}},[t._v("编辑")]):t._e()]}}])})],1),t._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:t.total2},on:{"current-change":t.handleCurrentChange2}})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"查看详情",visible:t.tableVisble2,width:"80%"},on:{"update:visible":function(e){t.tableVisble2=e}}},[i("div",{staticClass:"cTitle"},[t._v("垃圾编号： "+t._s(t.details.administratorId))]),t._v(" "),i("div",{staticClass:"flex detailBox"},[i("div",[i("div",{staticClass:"ball",staticStyle:{background:"#67C23A"}},[t._v("科室出库")]),t._v(" "),i("div",{staticClass:"infoBox infoBox1"},[i("div",[i("span",[t._v("所属类型：")]),t._v(" "+t._s(t.details.typeName))]),t._v(" "),i("div",[i("span",[t._v("垃圾重量：")]),t._v(" "+t._s(t.details.weight)+"kg ")]),t._v(" "),i("div",[i("span",[t._v("垃圾回收员：")]),t._v(" "+t._s(t.details.recyclerName))]),t._v(" "),i("div",[i("span",[t._v("垃圾回收时间：")]),t._v(" "+t._s(t.details.createdTime))]),t._v(" "),i("div",[i("span",[t._v("垃圾交接人：")]),t._v(" "+t._s(t.details.staffName))]),t._v(" "),i("div",[i("span",[t._v("异常信息：")]),t._v(" -")])])]),t._v(" "),i("div",[i("div",{staticClass:"ball",staticStyle:{background:"#E6A23C"}},[t._v("暂存点入库")]),t._v(" "),i("div",{staticClass:"infoBox"},[i("div",[i("span",[t._v("暂存点交接人：")]),t._v(" "+t._s(t.details.administratorName))]),t._v(" "),i("div",[i("span",[t._v("暂存点入库时间：")]),t._v(" "+t._s(t.details.storeTime))]),t._v(" "),i("div",[i("span",[t._v("暂存点核对重量：")]),t._v(" "+t._s(t.details.weight)+"kg")])])]),t._v(" "),i("div",[i("div",{staticClass:"ball",staticStyle:{background:"#F56C6C"}},[t._v("暂存点出库")]),t._v(" "),i("div",{staticClass:"infoBox"},[i("div",[i("span",[t._v("所属回收公司：")]),t._v(" "+t._s(t.details.companyName))]),t._v(" "),i("div",[i("span",[t._v("回收公司回收员：")]),t._v("- ")]),t._v(" "),i("div",[i("span",[t._v("回收时间：")]),t._v(t._s(t.details.recycleTime))])])])])]),t._v(" "),i("el-dialog",{attrs:{title:"编辑",visible:t.editVisible,width:"40%"},on:{"update:visible":function(e){t.editVisible=e}}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],ref:"ruleForm",attrs:{model:t.ruleForm,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"类型：",prop:"status"}},[i("el-radio-group",{model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},t._l(t.types,function(e,a){return i("el-radio",{key:a,attrs:{label:e.id}},[t._v(t._s(e.name))])}),1)],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveEdit("ruleForm")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};e.a=i},fb9z:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("/jMt"),s=a.n(i);for(var l in i)"default"!==l&&function(t){a.d(e,t,function(){return i[t]})}(l);var r=a("4mET");var o=function(t){a("ma5X")},n=a("C7Lr")(s.a,r.a,!1,o,"data-v-a69fb21a",null);e.default=n.exports},ma5X:function(t,e){}});
//# sourceMappingURL=12.ace1453c24ac794090c6.js.map